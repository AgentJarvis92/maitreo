import { Resend } from 'resend';

const apiKey = process.argv[2];
const resend = new Resend(apiKey);

const stripePortalUrl = 'https://billing.stripe.com/p/session/test_1234567890';
const unsubscribeUrl = 'https://maitreo.com/email-preferences';

const html = `<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Maitreo Activation</title></head><body style="font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: #f2f2f0; color: #1a1a1a; margin: 0; padding: 40px 16px;"><div style="background-color: #ffffff; max-width: 600px; margin: 0 auto; box-shadow: 0 10px 40px -10px rgba(0,0,0,0.05);"><header style="padding: 48px 32px 40px; text-align: center; border-bottom: 1px solid #e5e5e5;"><div style="font-size: 10px; font-weight: 500; letter-spacing: 0.25em; text-transform: uppercase; color: #1a1a1a;">Maitreo</div></header><main style="padding: 80px 32px 56px 56px;"><h1 style="font-size: 32px; line-height: 1.15; font-weight: 300; color: #1a1a1a; margin: 0 0 32px;">Maitreo is now active<br>for Test Restaurant.</h1><p style="font-size: 15px; line-height: 1.6; color: #4a4a4a; font-weight: 300; margin: 0 0 24px;">Your Google Business Profile is now being monitored. Every new review will be analyzed instantly, and you'll receive an SMS alert with a drafted response ready for your approval.</p><p style="font-size: 15px; line-height: 1.6; color: #4a4a4a; font-weight: 300; margin: 0 0 24px;">No dashboard. No logins. Just a text when something needs attention.</p><hr style="height: 1px; background: #e5e5e5; margin: 48px 0; border: none;"><h2 style="font-size: 10px; text-transform: uppercase; letter-spacing: 0.2em; color: #999999; font-weight: 500; margin: 0 0 32px;">When a review arrives</h2><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">APPROVE</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Post the reply instantly</div></div><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">EDIT</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Revise before posting</div></div><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">IGNORE</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Mark as handled</div></div><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">PAUSE</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Temporarily stop monitoring</div></div><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">RESUME</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Restart monitoring</div></div><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">STATUS</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Check system status</div></div><div style="display: flex; align-items: baseline; border-bottom: 1px solid #f0f0f0; padding: 14px 0;"><div style="width: 112px; flex-shrink: 0; font-family: 'Courier New'; font-size: 11px; font-weight: 700; color: #1a1a1a;">BILLING</div><div style="flex-grow: 1; font-size: 13px; color: #666666;">Manage subscription</div></div><hr style="height: 1px; background: #e5e5e5; margin: 48px 0; border: none;"><h2 style="font-size: 10px; text-transform: uppercase; letter-spacing: 0.2em; color: #999999; font-weight: 500; margin: 0 0 16px;">Your Subscription</h2><p style="font-size: 14px; line-height: 1.6; color: #4a4a4a; font-weight: 300; margin: 0 0 20px;">Your subscription is active. To manage billing, update your card, or cancel at any time, simply reply <span style="font-family: 'Courier New'; font-size: 11px; font-weight: 700;">BILLING</span> to any Maitreo message.</p><a href="${stripePortalUrl}" style="display: inline-block; font-size: 12px; color: #1a1a1a; text-decoration: none; border-bottom: 1px solid #1a1a1a; padding-bottom: 2px; letter-spacing: 0.05em; margin-top: 20px;">Manage or cancel your subscription →</a><div style="text-align: center; padding: 32px 0 0;"><div style="font-family: 'Playfair Display', serif; font-style: italic; font-size: 26px; color: #1a1a1a; margin: 0 0 40px;">Reputation, handled.</div><div style="display: inline-flex; align-items: center; gap: 10px; padding: 6px 16px; background: #fcfcfb; border: 1px solid #ebebeb; border-radius: 999px;"><div style="width: 6px; height: 6px; background: #4ade80; border-radius: 50%;"></div><span style="font-size: 9px; font-weight: 600; letter-spacing: 0.15em; text-transform: uppercase; color: #1a1a1a;">Active Monitoring</span></div></div></main><footer style="background: #fafaf8; padding: 32px; border-top: 1px solid #f0f0f0; text-align: center;"><p style="font-size: 10px; color: #999999; text-transform: uppercase; letter-spacing: 0.1em; margin: 0 0 12px;">© 2025 Maitreo Inc.</p><div style="font-size: 11px; color: #888888;"><a href="mailto:hello@maitreo.com" style="color: #888888; text-decoration: none;">hello@maitreo.com</a><span style="color: #cccccc; margin: 0 4px;">|</span><a href="${stripePortalUrl}" style="color: #888888; text-decoration: none;">Manage subscription</a><span style="color: #cccccc; margin: 0 4px;">|</span><a href="${unsubscribeUrl}" style="color: #888888; text-decoration: none;">Email preferences</a></div></footer></div></body></html>`;

(async () => {
  try {
    const result = await resend.emails.send({
      from: 'noreply@maitreo.com',
      to: 'kevin.j.reyes@gmail.com',
      subject: 'Maitreo is now active for Test Restaurant',
      html,
    });
    console.log('✅ Clean email sent!');
    console.log('ID:', result.data?.id);
  } catch (error) {
    console.error('Exception:', error.message);
  }
})();
